#!/usr/bin/env bash
set -eEu
set -o pipefail

. sdlc/functions.sh

echo "[INFO] Validate schemas"
BUNDLE_GEMFILE=src/Gemfile bundle exec octool validate schemas

echo
echo "[INFO] Validate data for example system"
docker-compose run validate

echo
echo "[INFO] Build SSP for example system"
docker-compose run ssp

echo
echo "[INFO] Run declarative checks"
pre-commit run --all-files --hook-stage manual

# Show positive feedback to developer.
echo
echo "[PASS] Tests OK"
